{
  "ruleset": "android",
  "files": [
    {
      "file_name": "WebViewJavaScriptEnabled.cql",
      "content": "/**\n * @name Android WebView JavaScript settings\n * @description Enabling JavaScript execution in a WebView can result in cross-site scripting attacks.\n * @kind problem\n * @id java/Android/webview-javascript-enabled\n * @problem.severity warning\n * @security-severity 6.1\n * @precision medium\n * @tags security\n * external/cwe/cwe-079\n */\nFROM method_invocation AS mi\nWHERE mi.getName() == \"setJavaScriptEnabled\" \u0026\u0026 \"true\" in mi.getArgumentName()\nSELECT mi.getName(), \"JavaScript enabled\""
    },
    {
      "file_name": "WebViewaddJavascriptInterface.cql",
      "content": "/**\n * @name Android WebView JavaScript settings\n * @description Enabling addJavascriptInterface exposes java methods to JavaScript.\n * @kind problem\n * @id java/Android/webview-javascript-enabled\n * @problem.severity warning\n * @security-severity 8.1\n * @precision medium\n * @tags security\n * external/cwe/cwe-079\n */\n\npredicate isJavaScriptEnabled(method_invocation mi) {\n  mi.getName() == \"addJavascriptInterface\"\n}\n\nFROM method_invocation AS mi\nWHERE isJavaScriptEnabled(mi)\nSELECT mi.getName(), \"JavaScript interface exposed\""
    },
    {
      "file_name": "WebViewsetAllowContentAccess.cql",
      "content": "/**\n * @name Android WebView JavaScript settings\n * @description Enabling setAllowContentAccess enables content:// access from webpages.\n * @kind problem\n * @id java/Android/webview-javascript-enabled\n * @problem.severity warning\n * @security-severity 6.1\n * @precision medium\n * @tags security\n * external/cwe/cwe-079\n */\nFROM method_invocation AS mi\nWHERE mi.getName() == \"setAllowContentAccess\" \u0026\u0026 \"true\" in mi.getArgumentName()"
    },
    {
      "file_name": "WebViewsetAllowFileAccess.cql",
      "content": "/**\n * @name Android WebView JavaScript settings\n * @description Enabling setAllowFileAccess enables webview access to file:/// URLs.\n * @kind problem\n * @id java/Android/webview-javascript-enabled\n * @problem.severity warning\n * @security-severity 6.1\n * @precision medium\n * @tags security\n * external/cwe/cwe-079\n */\nFROM method_invocation AS mi\nWHERE mi.getName() == \"setAllowFileAccess\" \u0026\u0026 \"true\" in mi.getArgumentName()"
    },
    {
      "file_name": "WebViewsetAllowFileAccessFromFileURLs.cql",
      "content": "/**\n * @name Android WebView JavaScript settings\n * @description Enabling setAllowFileAccessFromFileURLs leak s\u0026\u0026box access to file:/// URLs.\n * @kind problem\n * @id java/Android/webview-javascript-enabled\n * @problem.severity warning\n * @security-severity 6.1\n * @precision medium\n * @tags security\n * external/cwe/cwe-079\n */\nFROM method_invocation AS mi\nWHERE mi.getName() == \"setAllowFileAccessFromFileURLs\" \u0026\u0026 \"true\" in mi.getArgumentName()"
    }
  ]
}