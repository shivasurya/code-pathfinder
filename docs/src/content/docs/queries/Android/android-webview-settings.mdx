---
title: Android WebView JavaScript settings
description: "Code PathFinder Query for finding android webview javascript settings."
---
import PostHogLayout from '../../../../layouts/PostHogLayout.astro';
import { Badge } from '@astrojs/starlight/components';

<PostHogLayout>
</PostHogLayout>

## Android WebView JavaScript settings

Pathfinder supports querying for Android WebView JavaScript settings in the source code. Enabling this setting can
result in cross-site scripting attacks.

## Query Syntax <Badge text="CWE-079" variant="tip" size="small" />

### setJavaScriptEnabled Webview API
```sql
/**
 * @name Android WebView JavaScript settings
 * @description Enabling JavaScript execution in a WebView can result in cross-site scripting attacks.
 * @kind problem
 * @id java/android/webview-javascript-enabled
 * @problem.severity warning
 * @security-severity 6.1
 * @precision medium
 * @tags security
 * external/cwe/cwe-079
 */
FIND method_invocation AS mi WHERE mi.getName() == "setJavaScriptEnabled" && "false" in mi.getArgumentName()
```

### setAllowUniversalAccessFromFileURLs Webview API

```sql
/**
 * @name Android WebView JavaScript settings
 * @description Enabling SetAllowUniversalAccessFromFileURLs leak sandbox access to file:/// URLs from any origin.
 * @kind problem
 * @id java/android/webview-javascript-enabled
 * @problem.severity warning
 * @security-severity 6.1
 * @precision medium
 * @tags security
 * external/cwe/cwe-079
 */
FIND method_invocation AS mi WHERE mi.getName() == 'setAllowUniversalAccessFromFileURLs' AND mi.getArgumentName() = 'true'
```

### setAllowFileAccessFromFileURLs Webview API

```sql
/**
 * @name Android WebView JavaScript settings
 * @description Enabling setAllowFileAccessFromFileURLs leak sandbox access to file:/// URLs.
 * @kind problem
 * @id java/android/webview-javascript-enabled
 * @problem.severity warning
 * @security-severity 6.1
 * @precision medium
 * @tags security
 * external/cwe/cwe-079
 */
FIND method_invocation AS mi WHERE mi.getName() == 'setAllowFileAccessFromFileURLs' AND mi.getArgumentName() == 'true'
```

### setAllowContentAccess Webview API

```sql
/**
 * @name Android WebView JavaScript settings
 * @description Enabling setAllowContentAccess enables content:// access from webpages.
 * @kind problem
 * @id java/android/webview-javascript-enabled
 * @problem.severity warning
 * @security-severity 6.1
 * @precision medium
 * @tags security
 * external/cwe/cwe-079
 */
FIND method_invocation WHERE mi.getName() == 'setAllowContentAccess' AND mi.getArgumentName() == 'true'
```

### setAllowFileAccess Webview API

```sql
/**
 * @name Android WebView JavaScript settings
 * @description Enabling setAllowFileAccess enables webview access to file:/// URLs.
 * @kind problem
 * @id java/android/webview-javascript-enabled
 * @problem.severity warning
 * @security-severity 6.1
 * @precision medium
 * @tags security
 * external/cwe/cwe-079
 */
FIND method_invocation AS mi WHERE mi.getName() == 'setAllowFileAccess' AND mi.getArgumentName() == 'true'
```

### addJavascriptInterface Webview API

```sql
/**
 * @name Android WebView JavaScript settings
 * @description Enabling addJavascriptInterface exposes java methods to JavaScript.
 * @kind problem
 * @id java/android/webview-javascript-enabled
 * @problem.severity warning
 * @security-severity 8.1
 * @precision medium
 * @tags security
 * external/cwe/cwe-079
 */
FIND method_invocation AS mi WHERE mi.getName() == 'addJavascriptInterface'
```
